%: ----------------------- introduction file header -----------------------
\chapter{Introduction}

% the code below specifies where the figures are stored
\ifpdf
    \graphicspath{{1_introduction/figures/PNG/}{1_introduction/figures/PDF/}{1_introduction/figures/}}
\else
    \graphicspath{{1_introduction/figures/EPS/}{1_introduction/figures/}}
\fi

% ----------------------------------------------------------------------
%: ----------------------- introduction content ----------------------- 
% ----------------------------------------------------------------------

The use of computers for simulating complex real-world phenomena has found a firm
place in various engineering disciplines. Its success relies on the appropriate choice of an underlying mathematical-physical
model, its transformation into an efficient and accurate numerical method and ultimately into a fast and reliable computer
code. These steps, applied to the problem of neutron transport, present the basic structure of this thesis.

In the field of general radiative transfer, the Boltzmann's transport theory has been adopted as the most appropriate deterministic model. It describes the motion of particles and hence transfer of their energy on the macroscopic scale via the corresponding radiative intensity field. With only mentioning the vast amount of applications, ranging from astrophysics (where e.g. neutrinos are the studied particles) to e.g. radiative heat transfer caused by photons, this thesis will rather be focused solely on the transport of neutrons. In this case, the Boltzmann's transport equation (BTE) has the following form:
\begin{equation}\label{eq1}
  \frac1v \pd{\psi(\bx,\bomega,E,t)}{t} + \ldots
\end{equation}\todo{remaining terms}
and generally describes the evolution of the neutron intensity field $\psi$ (more often termed \textit{angular neutron flux}) in a given environment as a function of six phase-space variables:
\begin{itemize}
 	\item $\bx = (x,y,z) \in \R[3]$ represents the spatial distribution of neutrons,
 	\item $\bomega = (\theta, \phi) \in \R[2]$ represents the angular distribution of neutrons on a unit sphere, i.e. their motion directions,
 	\item $E\in \R[+]$ is the kinetic energy of neutrons.
\end{itemize} 
Due to the high-dimensionality of the solution of eq. \eqref{eq1}, its practical use for whole-domain calculations has always been very difficult. Various simplifications have therefore been attempted, more or less in accord with the underlying physics. 

The situation is relatively simplest in the energy domain, where the continuous dependence $\psi = \psi(\cdot, E)$ has been typically resolved by the so called \textit{multigroup approximation}. It transforms eq. \eqref{eq1} into a finite system of integro-differential equations, each governing neutrons with energies in a particular range (in this context called \textit{group}), coupled through the reactions caused by neutrons with different energies. This seemingly straightforward approach has been utilized in most of the computer codes developed and used until present. However, due to the complicated energetic dependence of nuclear processes, finding an optimal grouping of energies is a very delicate task.\todo{Refer to literature or some future section.}

While the multigroup approximation is probably the most universally used approach for the energy variable, significantly larger diversity exists among the methods approximating the directional dependence. Some of these methods were originally derived from the equivalent integral form of the BTE and are more suited for problems with smaller spatial dimensions, which however require highly accurate resolution of the directional dependence and nuclear properties (like fuel rod or single assembly lattice calculations)\footnote{These problems usually form first stages in the multi-stage calculations of the whole reactor core and require also the finest energetic group structuring. Their appropriately averaged results are then passed to the subsequent stages. See e.g. \cite[Chap. 17]{Reuss1} for more details about the core calculation scheme.}. Typical representatives are the collision probabilities methods (CPM) or the method of characteristics (MOC). Although use of these methods (particularly the latter) for whole core calculations have been recently reported in literature, this task is more often performed by the other group of angular approximation methods, derived from the integro-differential version of BTE, eq. \eqref{eq1}. The most successful of these latter methods have been the method of discrete ordinates ($\SN$) and the method of spherical harmonics ($\PN$). 

One of the reasons why all of the above methods are still used and actively developed today is that each of them has its own strengths and weaknesses that make it more suitable for one application area but less for the other. As already mentioned, the classical CPM, for instance, lead to problems with high degree of spatial coupling. Similarly, the classical MOC requires fine spatial discretization to overcome its low-order source term approximation, needed for derivation of the method. On the other hand, these methods quite naturally handle complex geometries and have therefore found their place in the solution of finer scale reactor analysis problems rather than, e.g. the whole core calculations. The $\SN$ method suffers from the possibility of producing a non-physical solution, while the $\PN$ method provably doesn't break the responsible physical law (rotational invariance of neutron-nuclei interactions), but leads to overly complicated system of equations and does not handle some widely used boundary conditions well. Not surprisingly, during the about four decades of development of all these methods, many of the deficiencies have been mitigated\todo{examples and citations}. This however usually complicated the practical implementation of the method and, to the author's knowledge, there is still no single all-purpose angular approximation method for the BTE today. 

Let us further turn our attention to the $\PN$ method. In principle, it represents the angular dependence according to the classical Galerkin method. That is, the angularly dependent quantities in \eqref{eq1} are expanded into infinite series of properly chosen functions that form a complete basis on the unit sphere, the equation is multiplied by each member of the basis in turn and integrated over the sphere. The properties of the basis functions are then used to derive conditions for the expansion coefficients. For practical purposes, of course, the expansion is truncated at finite length -- the $\PN$ method then corresponds to the $N$-th order expansion of the angular flux:
$$
  \psi(\bx,\bomega,t) = \sum_{k=0}^N \psi_k(\bx,\bomega,t) f_k(\bomega)
$$
The set of spherical basis functions originally used are the \textit{spherical harmonic functions}, which simplify the algebraic manipulations needed to arrive at the conditions for coefficients $\psi_k$ and have many other favorable properties\todo{reference to further section}. However, as this basis consists of complex functions and exhibits a banded structure in more than one dimension, i.e. there are $2n + 1$ spherical harmonics for each order (\textit{band}) $n$, the general $\PN$ expansion in 3D results in $(N+1)^2$ expansion coefficients (which are called \textit{angular moments} and are still continuous functions of space, energy and time). Even though this number can be somewhat reduced by transformation to the real domain, the number of unknowns still increases quadratically with $N$.

The $\PN$ equations for the angular moments $\psi_k$ can be written in the following form:
\begin{equation}\label{eq2}
  \frac1v \pd{\psi}{t} + \AA_x\pd{\psi}{x} + \AA_y\pd{\psi}{y} + \AA_z\pd{\psi}{z} + \MM\psi = \SS
\end{equation}\todo{dependencies}
This is a system of advection equations with constant advection field represented by the angular stiffness\todo{or mass?} matrices $\AA_x, \AA_y, \AA_z$. The off-diagonal elements in these matrices, however, complicate the approximation of the last dependence that we have not written about yet -- the spatial discretization -- although there is again a huge number of methods to choose from. The standard finite difference techniques result in non-symmetric, non-positive definite discrete problem which is much harder to solve than discrete problems arising from elliptic PDEs, while the classical continuous finite element methods (FEM) require additional stabilization means, which may be difficult to provide for general multidimensional meshes. The alternative techniques like the transport sweep from inflow to outflow boundaries of mesh cells is also more difficult to realize than in the $\SN$ methods (where the equations for each direction are decoupled and could be written in essentially the same form as eq. \eqref{eq2}, but with diagonal matrices), since it would require diagonalization of the angular stiffness matrices for each differently oriented cell. The best choice in terms of both accuracy, flexibility and stability seem to be the discontinuous Galerkin FEM, which were originally developed for the neutron transport problems, although for those based on the $\SN$ angular approximation\todo{verify this}. 

There is, however, another possibility to make the solution of the $\PN$ equations more feasible. The set of $\PN[1]$ equations, implying that the neutron flux varies only linearly in angle, can be under some additional compatible assumptions recast (even in 3D) into a single parabolic equation. This is known as the \textit{diffusion approximation} since the resulting equation describes the neutron transport as a diffusion process. Thanks to its simplicity and also the efficiency of the numerical solution techniques available for it, the diffusion approximation has always been the "workhorse of neutron reactor analyses"\todo{find the citation in Stacey}. The model is indeed sufficiently accurate for whole core calculations for contemporary reactors, assuming that the significant finer-scale neutron transport processes have been resolved by some higher-fidelity BTE solvers applied in previous solution stages. The self-adjoint diffusion equation can then be solved using e.g. the finite element method in conjunction with preconditioned conjugate gradients, imbued with adaptive mesh refinement based on highly developed a posteriori error estimates for elliptic problems. Note that the self-adjoint property of the diffusion model can only be spoiled by the multigroup energy discretization, where energy transfers in neutron collisions result in non-symmetric coupling of the multigroup system -- this can be however easily prevented by the traditional group-by-group iterative technique known as \textit{source iteration}.

Although methods based on the diffusion approximation have been experimentally proven to be widely applicable, there are situations where this approximation is just too coarse and, as some recent reports indicate (\cite{Hejzlar1,Cho1}), these cases are likely to grow soon with the advent of new reactor and fuel designs. Therefore the favorable mathematical structure of the diffusion equation made the researchers think about other ways of transforming the first-order $\PN$ equations into a set of second-order ones without losing the ability to capture the most important transport effects. The simplest approach is to generalize the procedure used to obtain the diffusion equation from the zeroth and first order equations of the $\PN[1]$ set. In more than one dimension, however, this leads to a complicated system of strongly coupled equations with mixed second-order derivatives, which do not exactly represent a system that is significantly easier to solve. But the nice features of the $\PN$ system in one dimension -- namely its size growing linearly with $N$ as opposed to quadratic growth in 2D and 3D and the just mentioned transformability into a set of diffusion-like equations -- piqued the interest of researchers and in the early 60's, a new method has been developed on these grounds. It was derived by simple formal replacement of one-dimensional differential operators by their multidimensional counterparts and hence received the name \textit{simplified $\PN$ approximation ($\SPN$)}.

Thanks to the simplicity and formal equivalence with the system of multigroup diffusion equations, many practitioners could swiftly implement the $\SPN$ approximation into their existing codes and begin with numerical experimentation \todo{citations}. Although most of them reported reasonable improvements in accuracy for the associated increase in computational requirements, there were some benchmarks for which the simple diffusion approximation actually provided better results\todo{there is an example in some article in Articles/SPN; find it and cite}. The validity of the Gelbard's formal derivation has therefore been questioned and the $\SPN$ equations have not been seriously considered as a robust enough improvement of the diffusion model for some time. This has changed in the 1990's where the asymptotic and variational analyses theoretically justified the method and also rigorously determined the range of validity of the approximation. Although it turned out that this range is not significantly larger than that of the diffusion theory, the $\SPN$ approximation has recently been shown to produce more correct results than the diffusion model under these conditions and is gaining popularity again. Moreover, some recent papers also start to uncover its underlying connections to the original Boltzmann's transport model and further research into the $\SPN$ model and its application seems to be an interesting topic.

The facts that the $\SPN$ method is not likely to perform well in non-diffusive transport regimes and, unlike the $\PN$ approximation, its solution may not in a general setting tend to the exact solution of the BTE as $N\to\inty$, make worthwile to investigate also other approaches leading to second-order problems after spatial discretization. One class of such methods is derived from the second-order forms of the BTE, like even and odd parity equations. 

\todo[inline]{SAAF, mixed partial derivatives in parity/SAAF equations, difficulties with void regions.}
\todo[inline]{Solid harmonics as alternative resolution of first-order BTE into a system of second-order equations.}
\todo[inline]{Least squares FEM, naturale a posteriori error estimate that can drive the adaptive mesh refinement}
\todo[inline]{Other methods, like wavelet based and sparse grid PN methods.}

